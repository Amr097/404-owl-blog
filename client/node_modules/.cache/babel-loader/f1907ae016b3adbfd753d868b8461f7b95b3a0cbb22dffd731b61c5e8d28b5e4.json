{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Owner/Desktop/github/Blog/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Owner/Desktop/github/Blog/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/Owner/Desktop/github/Blog/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/Owner/Desktop/github/Blog/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Owner/Desktop/github/Blog/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import'react-quill/dist/quill.snow.css';import{Navigate}from\"react-router-dom\";import{fetchEditPost}from\"../functions/fetchEditPost\";import{useParams}from\"react-router-dom\";import{Editor}from\"../functions/Editor\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function EditPost(){var _useState=useState({title:\"\",summary:\"\"}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),content=_useState4[0],setContent=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),files=_useState6[0],setFiles=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),redirect=_useState8[0],setRedirect=_useState8[1];//console.log(files)\nvar _useParams=useParams(),id=_useParams.id;useEffect(function(){fetchEditPost(setPost,setContent,setFiles,id);},[]);var postData=function postData(event){var name=event.target.name;//console.log(name)\nvar value=event.target.value;setPost(function(prevValue){return _objectSpread(_objectSpread({},prevValue),{},_defineProperty({},name,value));});};var postFiles=function postFiles(event){setFiles(event.target.files[0]);};var updatePost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();data=new FormData();data.set('title',post.title);data.set('summary',post.summary);if(files){data.set('file',files);}data.set('content',content);data.set('id',id);_context.next=9;return fetch('http://localhost:4000/update',{method:\"PATCH\",credentials:'include',body:data}).then(function(response){response.json().then(function(updatedPost){setPost({title:updatedPost.title,summary:updatedPost.summary});setContent(updatedPost.content);setRedirect(true);});if(response.ok){alert('Sucessfully updated');}else{alert('Failed to update');}});case 9:case\"end\":return _context.stop();}},_callee);}));return function updatePost(_x){return _ref.apply(this,arguments);};}();if(redirect){return/*#__PURE__*/_jsx(Navigate,{to:\"/post/\".concat(id)});}return/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsxs(\"form\",{className:\"post\",onSubmit:updatePost,children:[/*#__PURE__*/_jsx(\"input\",{onChange:postData,type:\"text\",name:\"title\",placeholder:\"Your Blog title\",value:post.title,required:true}),/*#__PURE__*/_jsx(\"input\",{onChange:postData,type:\"text\",name:\"summary\",placeholder:\"Summary\",value:post.summary}),/*#__PURE__*/_jsx(\"input\",{onChange:postFiles,type:\"file\",name:\"image\"}),/*#__PURE__*/_jsx(Editor,{value:content,onChange:setContent}),/*#__PURE__*/_jsx(\"button\",{id:\"post-btn\",type:\"submit\",children:\"Confirm\"})]})});}","map":{"version":3,"names":["React","useState","useEffect","Navigate","fetchEditPost","useParams","Editor","jsx","_jsx","jsxs","_jsxs","EditPost","_useState","title","summary","_useState2","_slicedToArray","post","setPost","_useState3","_useState4","content","setContent","_useState5","_useState6","files","setFiles","_useState7","_useState8","redirect","setRedirect","_useParams","id","postData","event","name","target","value","prevValue","_objectSpread","_defineProperty","postFiles","updatePost","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","data","wrap","_callee$","_context","prev","next","preventDefault","FormData","set","fetch","method","credentials","body","then","response","json","updatedPost","ok","alert","stop","_x","apply","arguments","to","concat","children","className","onSubmit","onChange","type","placeholder","required"],"sources":["C:/Users/Owner/Desktop/github/blog/client/src/components/EditPost.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport 'react-quill/dist/quill.snow.css';\r\nimport { Navigate } from \"react-router-dom\";\r\nimport { fetchEditPost } from \"../functions/fetchEditPost\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { Editor } from \"../functions/Editor\";\r\n\r\nexport default function EditPost() {\r\n    \r\n\r\n    const [post, setPost] = useState({title:\"\", summary:\"\"});\r\n    const [content, setContent] = useState(\"\");\r\n    const [files, setFiles] = useState(\"\");\r\n    const [redirect, setRedirect] = useState(false);\r\n    //console.log(files)\r\n    const {id} = useParams();\r\n\r\n\r\n  \r\n    useEffect(()=>{\r\n        fetchEditPost(setPost,setContent,setFiles,id);\r\n    }, []);\r\n\r\n\r\n    const postData = (event)=>{\r\n        const name = event.target.name;\r\n        //console.log(name)\r\n        const value = event.target.value;\r\n         setPost(prevValue=>{\r\n             return(\r\n                 {\r\n                   ...prevValue,\r\n                   [name] : value  \r\n                 }\r\n             )\r\n         })\r\n     }\r\n \r\n     const postFiles = event=> {\r\n       setFiles(event.target.files[0]);\r\n     }\r\n\r\n     const updatePost= async event=>{\r\n        event.preventDefault();\r\n        let data = new FormData()\r\n        data.set('title', post.title);\r\n        data.set('summary', post.summary);\r\n        if(files){\r\n            data.set('file', files);\r\n        }\r\n        data.set('content', content);\r\n        data.set('id', id)\r\n       \r\n        \r\n\r\n        await fetch('http://localhost:4000/update', {\r\n            method:\"PATCH\",\r\n            credentials: 'include',\r\n            body: data\r\n            \r\n        }).then(response=>{\r\n            response.json().then(updatedPost=>{\r\n                setPost({title: updatedPost.title, summary: updatedPost.summary});\r\n                setContent(updatedPost.content);\r\n                setRedirect(true);\r\n            })\r\n            if(response.ok){\r\n                alert('Sucessfully updated');\r\n                \r\n              }\r\n              else{\r\n                alert('Failed to update');\r\n              }\r\n        });\r\n    }\r\n \r\n\r\n    if(redirect){\r\n        return (<Navigate to={`/post/${id}`} />)\r\n        }\r\n\r\n\r\n  return(\r\n    <section>\r\n          <form className=\"post\" onSubmit={updatePost}>\r\n            <input onChange={postData} \r\n            type=\"text\" name=\"title\" \r\n            placeholder=\"Your Blog title\"  \r\n            value={post.title} required/>\r\n\r\n            <input onChange={postData} \r\n            type=\"text\" name=\"summary\" \r\n            placeholder=\"Summary\" value=\r\n            {post.summary}/>\r\n\r\n            <input onChange={postFiles}\r\n            type=\"file\" name=\"image\"/>\r\n\r\n            <Editor  value={content} onChange={setContent}/>\r\n            <button id=\"post-btn\" type=\"submit\">Confirm</button>\r\n          </form>\r\n        </section>\r\n  )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}